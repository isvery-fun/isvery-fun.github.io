<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Montserrat', sans-serif; 
            background-color: #000; 
            color: #fff; 
            text-align: center; 
            margin: 0;
        }
        .status-box { 
            width: 90%; 
            max-width: 800px; 
            margin: 10px auto; 
            padding: 15px; 
            border: 1px solid #444; 
            border-radius: 5px; 
            background-color: #111; 
        }
        .status-box h3 { 
            font-weight: 800; /* Montserrat ExtraBold */
        }
        .status { 
            font-weight: 700; /* Montserrat Bold */
        }
        .up { color: #0f0; }
        .down { color: #f00; }
        .uptime-bar { 
            height: 10px; 
            width: 100%; 
            background-color: #333; 
            position: relative; 
            margin-top: 5px; 
            border-radius: 5px;
        }
        .uptime-fill { 
            height: 100%; 
            background-color: #0f0; 
            border-radius: 5px;
        }
        a { 
            color: #0af; 
            text-decoration: none; 
        }
        a:hover { 
            text-decoration: underline; 
        }
        .incident-box {
            width: 90%;
            max-width: 800px;
            margin: 10px auto;
            padding: 10px;
            border-left: 5px solid #f90;
            background-color: #222;
            text-align: left;
        }
    </style>
</head>
<body>

    <div id="incidents"></div>

    <div id="status-container"></div>

    <script>
        const services = [
            { name: "host.ownaquamarine.ru", url: "https://host.ownaquamarine.ru", type: "http" },
            { name: "panel.ownaquamarine.ru", url: "https://panel.ownaquamarine.ru", type: "http" },
            { name: "n1.ownaquamarine.ru", url: "n1.ownaquamarine.ru", type: "ping" },
            { name: "bubblemc.ru", url: "bubblemc.ru", type: "ping" },
            { name: "play.minerun.ru", url: "play.minerun.ru", type: "ping" }
        ];

        const incidents = {
            "panel.ownaquamarine.ru": "Панель может быть недоступна с 23:00 до 6:30 по МСК",
            "host.ownaquamarine.ru": "Мы не гарантируем корректное отображение статуса"
        };

        function displayIncidents() {
            const incidentContainer = document.getElementById("incidents");
            for (const [site, message] of Object.entries(incidents)) {
                const div = document.createElement("div");
                div.className = "incident-box";
                div.innerHTML = `<strong>${site}</strong>: ${message}`;
                incidentContainer.appendChild(div);
            }
        }

        function createStatusBoxes() {
            const container = document.getElementById("status-container");
            services.forEach(service => {
                const div = document.createElement("div");
                div.className = "status-box";
                div.innerHTML = `
                    <h3>${service.type === "http" ? `<a href="${service.url}" target="_blank">${service.name}</a>` : service.name}</h3>
                    <p class="status" id="status-${service.name.replace(/\./g, "-")}">Проверка...</p>
                    <div class="uptime-bar"><div class="uptime-fill" id="uptime-${service.name.replace(/\./g, "-")}" style="width: 0%;"></div></div>
                    <p class="incident" id="incident-${service.name.replace(/\./g, "-")}">${incidents[service.name] || ""}</p>
                `;
                container.appendChild(div);
            });
        }

        async function checkHttp(url, statusId, uptimeId) {
            let start = Date.now();
            try {
                let response = await fetch(url, { method: 'GET', mode: 'no-cors' });
                let latency = Date.now() - start;
                document.getElementById(statusId).innerHTML = `✅ Доступен (${latency} мс)`;
                document.getElementById(statusId).classList.add("up");
                document.getElementById(uptimeId).style.width = "100%";
            } catch (e) {
                document.getElementById(statusId).innerHTML = "❌ Недоступен";
                document.getElementById(statusId).classList.add("down");
                document.getElementById(uptimeId).style.width = "0%";
            }
        }

        function checkPing(host, statusId, uptimeId) {
            let img = new Image();
            let start = Date.now();
            img.onload = () => {
                let latency = Date.now() - start;
                document.getElementById(statusId).innerHTML = `✅ Пинг: ${latency} мс`;
                document.getElementById(statusId).classList.add("up");
                document.getElementById(uptimeId).style.width = "100%";
            };
            img.onerror = () => {
                document.getElementById(statusId).innerHTML = "❌ Недоступен";
                document.getElementById(statusId).classList.add("down");
                document.getElementById(uptimeId).style.width = "0%";
            };
            img.src = `https://${host}/favicon.ico?${Date.now()}`;
        }

        function checkAll() {
            services.forEach(service => {
                const statusId = `status-${service.name.replace(/\./g, "-")}`;
                const uptimeId = `uptime-${service.name.replace(/\./g, "-")}`;

                if (service.type === "http") {
                    checkHttp(service.url, statusId, uptimeId);
                } else {
                    checkPing(service.url, statusId, uptimeId);
                }
            });
        }

        createStatusBoxes();
        displayIncidents();
        checkAll();
        setInterval(checkAll, 60000);
    </script>

</body>
</html>
